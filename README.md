# kotopogoda-uploader-android

Android-приложение для отбора и безопасной отправки фотографий на сервер (fly.io) в пайплайн "assets".

## Минимальные требования
- Android 8.0 (minSdk 26)
- Язык: Kotlin, UI: Jetpack Compose (Material 3)

> Приложение ориентировано на Android 14 (targetSdk 35).

## Статус
Каркас приложения готов и покрывает основные сценарии работы:

- **Мониторинг здоровья бэкенда** — `HealthMonitor` периодически обновляет состояние сервера и предоставляет его всем экранам, включая раздел «Статус» с расшифровкой сообщения, задержки и времени последней проверки.
- **Очередь отправок** — WorkManager управляет загрузками и опросами, а foreground-сервис поддерживает уведомление о прогрессе; на экране очереди можно отменять и повторять задачи с детальной диагностикой ошибок.
- **Навигация и сценарии запуска** — единый `NavHost` переключает онбординг, просмотрщик, очередь, статус, настройки и поток привязки устройства, реагируя на события и состояние привязки.
- **Логирование и диагностика** — файловый логгер на базе Timber включается из настроек, а модуль привязки сохраняет и экспортирует отдельный журнал действий для саппорта; архив диагностики включает HTTP-трафик и события WorkManager.
- **UI на Jetpack Compose** — экран просмотра фотографий поддерживает вертикальный pager, выбор папки, действия над фото и быстрый доступ к очереди/статусу; отдельные карточки статуса и очереди отображают агрегированную информацию о состоянии системы.

**Тестирование:**

- `./gradlew test` запускает unit-тесты, включая проверку маппинга ответов health API.
- `./gradlew :feature:viewer:connectedAndroidTest` выполняет Compose-инструментальные тесты экрана просмотра (требуется устройство/эмулятор).

### Ручные сценарии

- Просмотрщик: открыть список фотографий, нажать действие «К началу» (стрелка вверх) в верхней панели, убедиться, что показаны самые новые кадры и после возврата на экран прогресс закреплён на начале ленты.

## Разрешения
- Чтение медиаконтента (READ_MEDIA_IMAGES или READ_EXTERNAL_STORAGE для Android 12L и ниже) — требуется для просмотра и отправки фотографий.
- Камера — для сканирования QR-кода при привязке устройства.

## Сборка
Локальная сборка debug-APK:

```sh
gradle assembleDebug
```

## Документация
- Архитектура (черновик): app + core:data + core:network + feature:viewer + feature:onboarding
- Безопасность: привязка устройства (QR), HMAC-подпись запросов
- Контракт API: vendored через подмодуль `api/contract` (версия v1.4.1), официальная документация: https://artkoder.github.io/kotopogoda-api-contract/
- История изменений: [CHANGELOG](CHANGELOG.md)
